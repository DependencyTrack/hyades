package org.acme.model;

import io.quarkus.runtime.annotations.RegisterForReflection;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonProperty;

import java.io.Serializable;
import java.util.List;

@RegisterForReflection
public class VulnerabilityResult implements Serializable {

    @JsonIgnore
    private List<Vulnerability> vulnerabilities;
    private AnalyzerIdentity identity;
    private Component component;
    private String failureReason;

    public static VulnerabilityResult forFailure(final Throwable throwable, final Component component, final AnalyzerIdentity identity) {
        final var result = new VulnerabilityResult();
        result.setFailureReason(throwable.getMessage());
        result.setComponent(component);
        result.setIdentity(identity);
        result.setVulnerabilities(null);
        return result;
    }

    private boolean isCPE;

    private boolean isSwidTagID;

    public boolean isCPE() {
        return isCPE;
    }

    public void setCPE(boolean CPE) {
        isCPE = CPE;
    }

    public boolean isSwidTagID() {
        return isSwidTagID;
    }

    @JsonProperty
    public List<Vulnerability> getVulnerabilities() {
        return vulnerabilities;
    }

    public void setSwidTagID(boolean swidTagID) {
        isSwidTagID = swidTagID;
    }

    @JsonIgnore
    public void setVulnerabilities(List<Vulnerability> vulnerabilities) {
        this.vulnerabilities = vulnerabilities;
    }

    public AnalyzerIdentity getIdentity() {
        return identity;
    }

    public void setIdentity(AnalyzerIdentity identity) {
        this.identity = identity;
    }


    public Component getComponent() {
        return component;
    }

    public void setComponent(Component component) {
        this.component = component;
    }

    public String getFailureReason() {
        return failureReason;
    }

    public void setFailureReason(final String failureReason) {
        this.failureReason = failureReason;
    }

}
