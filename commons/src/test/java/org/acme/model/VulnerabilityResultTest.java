package org.acme.model;

import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

class VulnerabilityResultTest {

    @Test
    void testForFailure() {
        final var component = new Component();
        component.setName("foo");

        final var result = VulnerabilityResult.forFailure(new RuntimeException("bar"), component, AnalyzerIdentity.INTERNAL_ANALYZER);
        assertThat(result.getComponent()).isEqualTo(component);
        assertThat(result.getFailureReason()).isEqualTo("bar");
        assertThat(result.getIdentity()).isEqualTo(AnalyzerIdentity.INTERNAL_ANALYZER);
        assertThat(result.getVulnerabilities()).isNull();
    }

}