package org.hyades.vulnmirror.state;

import org.apache.kafka.streams.state.ReadOnlyKeyValueStore;
import org.hyades.vulnmirror.datasource.Datasource;

import javax.enterprise.context.ApplicationScoped;

@ApplicationScoped
public class VulnerabilityDigestStore {

    public byte[] get(final Datasource datasource, final String vulnId) {
        final ReadOnlyKeyValueStore<String, byte[]> store = StateStores.keyValueStore(StateStores.VULNERABILITY_DIGESTS);
        return store.get("%s/%s".formatted(datasource, vulnId));
    }

}
