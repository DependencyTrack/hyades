package org.acme.client.snyk;

import com.github.packageurl.MalformedPackageURLException;
import com.github.packageurl.PackageURL;
import com.github.packageurl.PackageURLBuilder;
import io.quarkus.test.common.http.TestHTTPResource;
import io.quarkus.test.junit.QuarkusTest;
import io.quarkus.test.junit.mockito.InjectMock;
import org.acme.client.ossindex.ComponentReportRequest;
import org.acme.client.ossindex.OssIndexClient;
import org.acme.model.Component;
import org.eclipse.microprofile.rest.client.inject.RestClient;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.Collections;

import static io.restassured.RestAssured.given;
import static org.hamcrest.CoreMatchers.is;
import static org.wildfly.common.Assert.assertNotNull;

@QuarkusTest
public class SnykClientTest {

    @InjectMock
    SnykClient snykClient;

    @Test
    public void getIssuesTest() throws MalformedPackageURLException, IOException {

        PackageURL purl = PackageURLBuilder.aPackageURL()
                .withType("maven").withNamespace("acme").withName("product").withVersion("1.0").build();

        Page<Issue> issuePage = snykClient.getIssues(purl.getCoordinates());
        assertNotNull(issuePage);
    }
}
