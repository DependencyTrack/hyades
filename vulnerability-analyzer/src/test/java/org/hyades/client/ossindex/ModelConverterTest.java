package org.hyades.client.ossindex;

import org.hyades.proto.vuln.v1.Source;
import org.hyades.proto.vuln.v1.Vulnerability;
import org.junit.jupiter.api.Test;

import java.util.List;

import static org.hyades.client.ossindex.ModelConverter.convert;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

public class ModelConverterTest {

    @Test
    public void testModelConverter() {

        ComponentReportVulnerability componentReportVulnerability = new ComponentReportVulnerability(
                "test-id", "", "", "", 7.3f, "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
                "CWE-300", "CVE-test", "", List.of("")
        );

        Vulnerability vulnerability = convert(componentReportVulnerability);
        assertNotNull(vulnerability);
        assertEquals("CVE-test", vulnerability.getId());
        assertEquals(Source.SOURCE_NVD, vulnerability.getSource());
        assertEquals(300, vulnerability.getCwesList().get(0));
        assertEquals(7.3, vulnerability.getRatings(0).getScore());
    }
}
