package org.acme.processor.internal;

import org.acme.model.Component;
import org.acme.model.VulnerabilityResult;
import org.acme.persistence.VulnerableSoftwareRepository;
import org.apache.kafka.streams.processor.api.Processor;
import org.apache.kafka.streams.processor.api.ProcessorSupplier;

import javax.enterprise.context.ApplicationScoped;
import javax.inject.Inject;

@ApplicationScoped
public class InternalScannerProcessorSupplier implements ProcessorSupplier<String, Component, String, VulnerabilityResult> {

    private final VulnerableSoftwareRepository vulnerableSoftwareRepository;

    @Inject
    public InternalScannerProcessorSupplier(final VulnerableSoftwareRepository vulnerableSoftwareRepository) {
        this.vulnerableSoftwareRepository = vulnerableSoftwareRepository;
    }

    @Override
    public Processor<String, Component, String, VulnerabilityResult> get() {
        return new InternalScannerProcessor(vulnerableSoftwareRepository);
    }

}
