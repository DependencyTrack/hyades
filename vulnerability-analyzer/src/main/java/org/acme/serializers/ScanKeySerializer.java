package org.acme.serializers;

import org.acme.modelx.ScanKey;
import org.apache.commons.lang3.StringUtils;
import org.apache.kafka.common.errors.SerializationException;
import org.apache.kafka.common.serialization.Serializer;

import java.nio.charset.StandardCharsets;

public class ScanKeySerializer implements Serializer<ScanKey> {

    @Override
    public byte[] serialize(final String topic, final ScanKey data) {
        if (data == null) {
            throw new SerializationException("data must not be null");
        }
        if (StringUtils.isBlank(data.token())) {
            throw new SerializationException("token must not be blank");
        }
        if (data.component() == null) {
            throw new SerializationException("component uuid must not be null");
        }
        return "%s/%s".formatted(data.token(), data.component()).getBytes(StandardCharsets.UTF_8);
    }

}
