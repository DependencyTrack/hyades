package org.acme.modelx;

import io.quarkus.runtime.annotations.RegisterForReflection;
import org.acme.model.Vulnerability;

import java.util.List;

@RegisterForReflection
public record ScanResult(ScanKey key, ScannerIdentity identity, ScanStatus status,
                         List<Vulnerability> vulnerabilities, String failureReason) {

    public static Builder builder(final ScanKey scanKey, final ScannerIdentity identity) {
        return new Builder(scanKey, identity);
    }

    public static final class Builder {

        private final ScanKey scanKey;
        private final ScannerIdentity identity;
        private ScanStatus status;
        private List<Vulnerability> vulnerabilities;
        private String failureReason;

        private Builder(final ScanKey scanKey, final ScannerIdentity identity) {
            this.scanKey = scanKey;
            this.identity = identity;
        }

        public Builder withStatus(final ScanStatus status) {
            this.status = status;
            return this;
        }

        public Builder withVulnerabilities(final List<Vulnerability> vulnerabilities) {
            this.vulnerabilities = vulnerabilities;
            return this;
        }

        public Builder withFailureReason(final String failureReason) {
            this.failureReason = failureReason;
            return this;
        }

        public ScanResult build() {
            return new ScanResult(scanKey, identity, status, vulnerabilities, failureReason);
        }

    }

}
